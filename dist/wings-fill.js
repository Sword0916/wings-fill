(function(h,f){typeof exports=="object"&&typeof module<"u"?module.exports=f():typeof define=="function"&&define.amd?define(f):(h=typeof globalThis<"u"?globalThis:h||self,h.WingsFill=f())})(this,function(){"use strict";function h(t){return(typeof t=="number"||t instanceof Number)&&!isNaN(t)}function f(t){return typeof t=="boolean"}function l(t){return typeof t=="function"}class d{constructor(){this.startTime=null,this.finishTime=null,this.deltaTime=null,this.pauseTime=null,this.delayTime=0,this.pauseDuration=0}start(){this.pauseTime=null,this.pauseDuration=0,this.startTime=Date.now()}pause(){this.pauseTime=Date.now()}play(){this.pauseDuration+=this.pauseTime?Date.now()-this.pauseTime:0}delay(e){this.delayTime=e}timing(){this.deltaTime=Date.now()-this.startTime-this.pauseDuration-this.delayTime,this.deltaTime=this.deltaTime>0?this.deltaTime:0}stop(){this.finishTime=Date.now(),this.deltaTime=this.finishTime-this.startTime-this.pauseDuration-this.delayTime,this.deltaTime=this.deltaTime>0?this.deltaTime:0}correctTime(e){this.startTime-=e}}class p{constructor(e){this.original=new Map,this.saveOriginal(e)}saveOriginal(e){for(let i in e){const s=e[i];h(s)&&this.original.set(i,s)}}has(e){return this.original.has(e)}get(e){return this.original.has(e)?this.original.get(e):null}}const o={Linear:function(t,e,i,s){return i*t/s+e},Quad:{easeIn:function(t,e,i,s){return i*(t/=s)*t+e},easeOut:function(t,e,i,s){return-i*(t/=s)*(t-2)+e},easeInOut:function(t,e,i,s){return(t/=s/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e}},Cubic:{easeIn:function(t,e,i,s){return i*(t/=s)*t*t+e},easeOut:function(t,e,i,s){return i*((t=t/s-1)*t*t+1)+e},easeInOut:function(t,e,i,s){return(t/=s/2)<1?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e}},Quart:{easeIn:function(t,e,i,s){return i*(t/=s)*t*t*t+e},easeOut:function(t,e,i,s){return-i*((t=t/s-1)*t*t*t-1)+e},easeInOut:function(t,e,i,s){return(t/=s/2)<1?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e}},Quint:{easeIn:function(t,e,i,s){return i*(t/=s)*t*t*t*t+e},easeOut:function(t,e,i,s){return i*((t=t/s-1)*t*t*t*t+1)+e},easeInOut:function(t,e,i,s){return(t/=s/2)<1?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e}},Sine:{easeIn:function(t,e,i,s){return-i*Math.cos(t/s*(Math.PI/2))+i+e},easeOut:function(t,e,i,s){return i*Math.sin(t/s*(Math.PI/2))+e},easeInOut:function(t,e,i,s){return-i/2*(Math.cos(Math.PI*t/s)-1)+e}},Expo:{easeIn:function(t,e,i,s){return t==0?e:i*Math.pow(2,10*(t/s-1))+e},easeOut:function(t,e,i,s){return t==s?e+i:i*(-Math.pow(2,-10*t/s)+1)+e},easeInOut:function(t,e,i,s){return t==0?e:t==s?e+i:(t/=s/2)<1?i/2*Math.pow(2,10*(t-1))+e:i/2*(-Math.pow(2,-10*--t)+2)+e}},Circ:{easeIn:function(t,e,i,s){return-i*(Math.sqrt(1-(t/=s)*t)-1)+e},easeOut:function(t,e,i,s){return i*Math.sqrt(1-(t=t/s-1)*t)+e},easeInOut:function(t,e,i,s){return(t/=s/2)<1?-i/2*(Math.sqrt(1-t*t)-1)+e:i/2*(Math.sqrt(1-(t-=2)*t)+1)+e}},Elastic:{easeIn:function(t,e,i,s,n,r){var u;return t==0?e:(t/=s)==1?e+i:(typeof r>"u"&&(r=s*.3),!n||n<Math.abs(i)?(u=r/4,n=i):u=r/(2*Math.PI)*Math.asin(i/n),-(n*Math.pow(2,10*(t-=1))*Math.sin((t*s-u)*(2*Math.PI)/r))+e)},easeOut:function(t,e,i,s,n,r){var u;return t==0?e:(t/=s)==1?e+i:(typeof r>"u"&&(r=s*.3),!n||n<Math.abs(i)?(n=i,u=r/4):u=r/(2*Math.PI)*Math.asin(i/n),n*Math.pow(2,-10*t)*Math.sin((t*s-u)*(2*Math.PI)/r)+i+e)},easeInOut:function(t,e,i,s,n,r){var u;return t==0?e:(t/=s/2)==2?e+i:(typeof r>"u"&&(r=s*(.3*1.5)),!n||n<Math.abs(i)?(n=i,u=r/4):u=r/(2*Math.PI)*Math.asin(i/n),t<1?-.5*(n*Math.pow(2,10*(t-=1))*Math.sin((t*s-u)*(2*Math.PI)/r))+e:n*Math.pow(2,-10*(t-=1))*Math.sin((t*s-u)*(2*Math.PI)/r)*.5+i+e)}},Back:{easeIn:function(t,e,i,s,n){return typeof n>"u"&&(n=1.70158),i*(t/=s)*t*((n+1)*t-n)+e},easeOut:function(t,e,i,s,n){return typeof n>"u"&&(n=1.70158),i*((t=t/s-1)*t*((n+1)*t+n)+1)+e},easeInOut:function(t,e,i,s,n){return typeof n>"u"&&(n=1.70158),(t/=s/2)<1?i/2*(t*t*(((n*=1.525)+1)*t-n))+e:i/2*((t-=2)*t*(((n*=1.525)+1)*t+n)+2)+e}},Bounce:{easeIn:function(t,e,i,s){return i-o.Bounce.easeOut(s-t,0,i,s)+e},easeOut:function(t,e,i,s){return(t/=s)<1/2.75?i*(7.5625*t*t)+e:t<2/2.75?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e},easeInOut:function(t,e,i,s){return t<s/2?o.Bounce.easeIn(t*2,0,i,s)*.5+e:o.Bounce.easeOut(t*2-s,0,i,s)*.5+i*.5+e}}};class c{constructor(e){this.startEntity=e,this.endEntity=null,this.startEdge=null,this.endEdge=null,this.duration=100,this.isLoop=!1,this.repeatNum=1,this.startFun=null,this.updateFun=null,this.pauseFun=null,this.playFun=null,this.completeFun=null,this.easingFun=o.Linear,this.clock=new d,this.previousFill=null,this.nextFill=null,this.isStart=!1,this.isPause=!1,this.isComplete=!1,this.isReverse=!1,this.isYoyo=!1,Object.getPrototypeOf(c).instances.push(this)}reverse(){return this.isReverse=!this.isReverse,[this.startEdge,this.endEdge]=[this.endEdge,this.startEdge],this.isReverse?this.previousFill&&this.previousFill.isReverse!=this.isReverse&&this.previousFill.reverse():this.nextFill&&this.nextFill.isReverse!=this.isReverse&&this.nextFill.reverse(),this}from(e){return this.startEntity=e,this}to(e,i){return this.endEntity=e,this.duration=h(i)&&i!=0?i:this.duration,this}yoyo(e){return this.isYoyo=f(e)?e:!1,this}repeat(e){return this.isLoop=!(h(e)&&e>=1),this.repeatNum=this.isLoop?1:Number.parseInt(e),this}easing(e){return this.easingFun=l(e)?e:o.Linear,this}start(){return this.isStart=!0,this.isPause=!1,this.isComplete=!1,this.startEdge=this.startEdge||new p(this.startEntity),this.endEdge=this.endEdge||new p(this.endEntity),this.clock.start(),this.startFun&&this.startFun(this.startEntity),this}delay(e){return h(e)&&this.clock.delay(e),this}update(e=!1){if(!this.isStart&&!this.isComplete)return this;if(!this.isComplete&&!this.isPause){this.clock.timing();let i=this.clock.deltaTime/this.duration;!this.isLoop&&i>=this.repeatNum&&(this.clock.stop(),this.isStart=!1,this.isComplete=!0),this._updateEntityValue(),this.updateFun&&this.updateFun(this.startEntity),this.isComplete&&this._handleComplete()}else!e&&this.isComplete&&this.nextFill&&this.nextFill.update();return this}pause(e=!1){return!this.isStart&&!this.isComplete?this:(!this.isComplete&&!this.isPause?(this.isPause=!0,this.clock.pause(),this.pauseFun&&this.pauseFun(this.startEntity)):!e&&this.isComplete&&this.nextFill&&this.nextFill.pause(),this)}play(e=!1){return!this.isStart&&!this.isComplete?this:(!this.isComplete&&this.isPause?(this.isPause=!1,this.clock.play(),this.playFun&&this.playFun(this.startEntity)):!e&&this.isComplete&&this.nextFill&&this.nextFill.play(),this)}chain(e){return e instanceof c?(this.nextFill=e,this.nextFill.yoyo(this.isYoyo),this.nextFill.previousFill=this):this.nextFill=null,this.nextFill}_updateEntityValue(){const e=this.clock.deltaTime%this.duration;this.endEdge.original.forEach((i,s)=>{if(this.startEdge.has(s)){const n=this.startEdge.get(s),r=i-n;this.startEntity[s]=this.isComplete?i:this.easingFun(e,n,r,this.duration)}})}_handleComplete(){this.completeFun&&this.completeFun(this.startEntity),!this.isReverse&&this.nextFill?(this.nextFill.startEntity||this.nextFill.from(this.startEntity),this.nextFill.start(),this.nextFill.clock.correctTime(this.clock.deltaTime%this.duration)):this.isReverse&&this.previousFill?(this.previousFill.startEntity||this.previousFill.from(this.startEntity),this.previousFill.start(),this.previousFill.clock.correctTime(this.clock.deltaTime%this.duration)):this.isYoyo&&(this.reverse().start(),this.clock.correctTime(this.clock.deltaTime%this.duration))}onStart(e){return this.startFun=l(e)?e:null,this}onUpdate(e){return this.updateFun=l(e)?e:null,this}onComplete(e){return this.completeFun=l(e)?e:null,this}onPause(e){return this.pauseFun=l(e)?e:null,this}onPlay(e){return this.playFun=l(e)?e:null,this}}const a=Object.getPrototypeOf(c);return a.Easing=o,a.instances=[],a.update=()=>{a.instances.forEach(t=>{t.update(!0)})},a.pause=()=>{a.instances.forEach(t=>{t.pause(!0)})},a.play=()=>{a.instances.forEach(t=>{t.play(!0)})},c});
